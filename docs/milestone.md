# 改进需求与开发规划
本次改进目标使冥王星可以真正的被用户使用起来，至少满足本团队成员日常生活中涉及到的日历、任务和备忘的需求。

## 改进需求
针对目前冥王星的功能以及概念定义上的改进

1. 日历、任务和备忘的概念定义

    目前版本的冥王星只定义了日程的概念，体现在用户新创建的日程，以及从系统日历下载的日历内容都存储在日程表中，没有进行区分。

    以下是本次改进对日历、任务和备忘的定义

    |     | 日历<sup>[1](#note-calendar-object)</sup> | 日程<sup>[2](#note-task-object)</sup> | 任务<sup>[2](#note-task-object)</sup> | 小任务<sup>[2](#note-task-object)</sup> | 备忘事<sup>[3](#note-memo-object)</sup> | 备忘信息<sup>[3](#note-memo-object)</sup> |
    | --- | :----: | :----: | :----: | :----: | :----: | :----: |
    | 提醒 | 是 | 是 | 是 | 是 | 无 | 无 |
    | 事后提醒 | 否 | 否 | 是 | 否 | 无 | 无 |
    | 要求确认 | 否 | 是 | 是 | 否 | 是<sup>[Q1](#note-question-1)</sup> | 无 |
    | 时间维度 | 开始 | 开始 | 开始+结束 | 无 | 当前时间 | 无 |
    | 状态 | 无 | 时间过后无 | 结束后无 | 提醒过后无 | 无 | 无 |
    | 分享 | 是 | 是 | 是 | 无 | 无 | 无 |
    | 邀请 | 无 | 是 | 是 | 无 | 无 | 无 |
    | 具体信息 | 无 | 有 | 有 | 无 | 无 | 无 |

    <a name="note-calendar-object">1. 日历</a>: 具备日期、名称的对象为日历对象，例如：农历节气中的"2019年7月23日 大暑"是日历对象，日历由多个对象组成，并赋予名称

    <a name="note-task-object">2. 任务</a>: 任务分为日程、任务和小任务

    <a name="note-memo-object">3. 备忘</a>: 备忘分为事和信息，例如：通过语音记录的借钱/还钱记录到备忘事中，不同日期的多次记录保存到同一条备忘中

2. 通知与提醒

    由于手机厂商对安卓系统定制深度不同，导致应用在被关闭之后，本地的提醒无法准时提醒用户，现对通知和提醒做以下定义和实现方案

    1. 通知和提醒的概念定义

    *通知* 为无精确时效要求的信息传达，用户可以在发生前或者发生后再收到; *提醒* 为有精确时效要求的信息传达，用户只有在发生时收到。

    以下是冥王星中信息传达的具体分类

    | | 通知 | 提醒 |
    |-|:----:|:---:|
    |智能提醒 每日简报| 通知 | - |
    |智能提醒 极端气候警报| 通知 | - |
    |日历 生日提醒| 通知 | - |
    |日历 结婚纪念日提醒| 通知 | - |
    |日历 世界杯小组赛 A组 第一场比赛提醒| 通知 | - |
    |日程 接收邀请通知| 通知 | - |
    |日程 提前10分钟提醒| - | 提醒 |
    |任务 接收邀请通知| 通知 | - |
    |任务 提前10分钟提醒| - | 提醒 |
    |任务 事后提醒| 通知 | - |
    |小任务 提前10分钟提醒| - | 提醒 |

    2. 正常过程 *一方或关联多方在事件发生时冥王星处于联机状态*

    | | 时间线 | 用户A | 用户B | 处理逻辑 |
    |-|:-:|:---:|:---:|:-|
    |1|第一天 上午|创建日程 __*明天下午三点开项目总结会*__| |用户A本地+服务器端保存|
    |2|第一天 上午|设置 __*提前10分钟提醒*__| |用户A本地+服务器端保存|
    |3|第一天 上午|邀请 __*用户B*__ 参加| |用户A本地+服务器端保存, 发送通知和透传消息给用户B|
    |4|第一天 上午/下午||收到 __*用户A*__ __*明天下午三点开项目总结会*__ 通知|收到通知显示在系统通知栏上, <br/>收到透传消息缓存日程到用户B本地|
    |5|第一天 上午/下午||接受邀请|用户B本地+服务器端保存|
    |6|第二天 上午|追加设置 __*提前30分钟提醒*__||用户A本地+服务器端保存, <br/>发送透传消息给用户B, <br/>用户B收到消息后, 用户B本地+服务器端保存|
    |7|第二天 下午两点半|收到 __*下午三点开项目总结会通知+提醒*__|收到 __*下午三点开项目总结会通知+提醒*__|服务端发送通知和透传消息给用户A和用户B<br/>(1分钟内接收有效), <br/>两个客户端收到通知显示在系统通知栏上, <br/>收到透传消息自动进行语音播报, <br/>用户点击通知栏中的通知, 打开对应的日程画面|
    |8|第二天 下午两点五十分|收到 __*下午三点开项目总结会通知+提醒*__|收到 __*下午三点开项目总结会通知+提醒*__|同上|

    3. 异常过程1 *一方或关联多方在部分事件发生时冥王星处于离线状态*

    用户B在第二天冥王星一直处于离线状态, 直到第三天上午才上线, 手机处于开机状态

    | | 时间线 | 用户A | 用户B | 处理逻辑 |
    |-|:-:|:---:|:---:|:-|
    |1|第一天 上午|创建日程 __*明天下午三点开项目总结会*__| |用户A本地+服务器端保存|
    |2|第一天 上午|设置 __*提前10分钟提醒*__| |用户A本地+服务器端保存|
    |3|第一天 上午|邀请 __*用户B*__ 参加| |用户A本地+服务器端保存, 发送通知和透传消息给用户B|
    |4|第一天 上午/下午||收到 __*用户A*__ __*明天下午三点开项目总结会*__ 通知|收到通知显示在系统通知栏上, <br/>收到透传消息缓存日程到用户B本地|
    |5|第一天 上午/下午||接受邀请|用户B本地+服务器端保存|
    |6*|第二天 上午|追加设置 __*提前30分钟提醒*__||用户A本地+服务器端保存, <br/>发送透传消息给用户B ~~, <br/>用户B收到消息后, 用户B本地+服务器端保存~~<br/>(该透传消息到下午两点半前有效)|
    |7*|第二天 下午两点半|收到 __*下午三点开项目总结会通知+提醒*__|收到 __*下午三点开项目总结会通知+提醒*__|服务端发送通知和透传消息给用户A和用户B<br/>(1分钟内接收有效), <br/>两个客户端收到通知显示在系统通知栏上, <br/>用户A收到透传消息自动进行语音播报, <br/>用户B没有自动语音播报,<br/>用户A点击通知栏中的通知, 打开对应的日程画面,<br/>用户B没有打开通知|
    |8*|第二天 下午两点五十分|收到 __*下午三点开项目总结会通知+提醒*__|收到 __*下午三点开项目总结会通知+提醒*__|同上|
    |9*|第三天||打开冥王星, 并打开昨天 __*开项目总结会*__ 日程|日历首页不显示新消息提醒(红点), 日程页面不显示任何提醒设置项|

    用户B从第一天开始冥王星一直处于离线状态, 直到第三天上午才上线, 手机处于开机状态

    | | 时间线 | 用户A | 用户B | 处理逻辑 |
    |-|:-:|:---:|:---:|:-|
    |1|第一天 上午|创建日程 __*明天下午三点开项目总结会*__| |用户A本地+服务器端保存|
    |2|第一天 上午|设置 __*提前10分钟提醒*__| |用户A本地+服务器端保存|
    |3|第一天 上午|邀请 __*用户B*__ 参加| |用户A本地+服务器端保存, 发送通知和透传消息给用户B|
    |4|第一天 上午/下午||收到 __*用户A*__ __*明天下午三点开项目总结会*__ 通知|收到通知显示在系统通知栏上 ~~, <br/>收到透传消息缓存日程到用户B本地~~|
    |5|第一天 上午/下午||~~接受邀请~~|~~用户B本地+服务器端保存~~|
    |6*|第二天 上午|追加设置 __*提前30分钟提醒*__||用户A本地+服务器端保存 ~~, <br/>发送透传消息给用户B, <br/>用户B收到消息后, 用户B本地+服务器端保存<br/>(该透传消息到下午两点半前有效)~~|
    |7*|第二天 下午两点半|收到 __*下午三点开项目总结会通知+提醒*__|~~收到 __*下午三点开项目总结会通知+提醒*__~~|服务端发送通知和透传消息给用户A~~和用户B~~<br/>(1分钟内接收有效), <br/>用户A客户端收到通知显示在系统通知栏上, <br/>用户A收到透传消息自动进行语音播报, <br/>~~用户B没有自动语音播报,<br/>~~用户A点击通知栏中的通知, 打开对应的日程画面~~,<br/>用户B没有打开通知~~|
    |8*|第二天 下午两点五十分|收到 __*下午三点开项目总结会通知+提醒*__|~~收到 __*下午三点开项目总结会通知+提醒*__~~|同上|
    |9*|第三天||打开冥王星<sup>[Q2](#note-question-2)</sup> ~~, 并打开昨天 __*开项目总结会*__ 日程~~|~~日历首页不显示新消息提醒(红点), 日程页面不显示任何提醒设置项~~|


## 问题
<a name="note-question-1">1. 备忘事不能被邀请，怎么会有确认？</a>: 待确认
<a name="note-question-2">2. 如果第4步接收到的通知仍然存在于系统通知栏上, 这个时候用户再去点开通知, 页面应该如何显示？</a>: 显示日程内容, 弹出已过期? 还是直接就进入日历画面, 不进入对应的日程画面(因为还没有选择是否接受, 而且这个日程已经过期)?

类似借钱这样的事情记录在备忘里面，记录在同一条记录里面，而不要显示在日程里面

过去的日程，不能共享，不显示提醒，可以创建
任务只能创建未来的时间或者不指定时间

单独给别人的任务或日程，只提醒对方，画面可以选择只提醒对方或者也提醒自己
只让对方看到

分享和邀请，不考虑公开和私有，共享一个连接，点开后都能加入，不能再分享。
邀请时可选只有自己修改，所有人都可以修改，自己是否保留日程。
只有自己修改，别人不能再邀请，都有人都可以修改，别人都可以邀请。
不保留日程，只能选择都有人都可以修改

只有自己修改的模式不能改成所有人都可以修改，反之亦然
需要改变模式，重新创建
