version: "3.3"
services:
  zuulserver:
    image: 192.168.0.158:5000/xiaoji-zuulserver
    hostname: zuulserver
    configs:
      - source: zuul_config
        target: /usr/local/tomcat/webapps/ROOT/WEB-INF/classes/application.properties

    networks:
      - mwxing-network-overlay
    deploy:
      replicas: 1
      endpoint_mode: dnsrr

  sa-aac:
    image: 192.168.0.158:5000/xiaoji-sa-aac
    hostname: sa-aac
    configs:
      - source: aac_config
        target: /usr/local/tomcat/webapps/ROOT/WEB-INF/classes/application.properties

    networks:
      - mwxing-network-overlay
    deploy:
      replicas: 1
      endpoint_mode: dnsrr

  sa-aba:
    image: 192.168.0.158:5000/xiaoji-sa-aba
    hostname: sa-aba
    configs:
      - source: aba_config
        target: /usr/local/tomcat/webapps/aba/WEB-INF/classes/application.properties

    networks:
      - mwxing-network-overlay
    deploy:
      replicas: 1
      endpoint_mode: dnsrr

  sa-abc:
    image: 192.168.0.158:5000/xiaoji-sa-abc
    hostname: sa-abc
    configs:
      - source: abc_config
        target: /usr/local/tomcat/webapps/abc/WEB-INF/classes/application.properties

    networks:
      - mwxing-network-overlay
    deploy:
      replicas: 1
      endpoint_mode: dnsrr

  sa-abd:
    image: 192.168.0.158:5000/xiaoji-sa-abd
    hostname: sa-abd
    configs:
      - source: abd_config
        target: /usr/local/tomcat/webapps/abd/WEB-INF/classes/application.properties

    networks:
      - mwxing-network-overlay
    deploy:
      replicas: 1
      endpoint_mode: dnsrr

  sa-agd:
    image: 192.168.0.158:5000/xiaoji-sa-agd
    hostname: sa-agd
    configs:
      - source: agd_config
        target: /usr/local/tomcat/webapps/agd/WEB-INF/classes/application.properties

    networks:
      - mwxing-network-overlay
    deploy:
      replicas: 1
      endpoint_mode: dnsrr

  sa-sha:
    image: 192.168.0.158:5000/xiaoji-sa-sha
    hostname: sa-sha
    configs:
      - source: sha_config
        target: /usr/verticles/sha.json
      - source: sha_chinese_holiday_2019_config
        target: /opt/duan/sha/plan/chinese_holiday_2019.json
      - source: sha_chinese_holiday_2019_agendas_config
        target: /opt/duan/sha/plan-agendas/chinese_holiday_2019.json
      - source: sha_chinese_famous_2019_config
        target: /opt/duan/sha/plan/chinese_famous_2019.json
      - source: sha_chinese_famous_2019_agendas_config
        target: /opt/duan/sha/plan-agendas/chinese_famous_2019.json
      - source: sha_chinese_follow_2019_config
        target: /opt/duan/sha/plan/chinese_follow_2019.json
      - source: sha_chinese_follow_2019_agendas_config
        target: /opt/duan/sha/plan-agendas/chinese_follow_2019.json
      - source: sha_shanghai_animation_exhibition_2019_config
        target: /opt/duan/sha/plan/shanghai_animation_exhibition_2019.json
      - source: sha_shanghai_animation_exhibition_2019_agendas_config
        target: /opt/duan/sha/plan-agendas/shanghai_animation_exhibition_2019.json
      - source: sha_west_holiday_2019_config
        target: /opt/duan/sha/plan/west_holiday_2019.json
      - source: sha_west_holiday_2019_agendas_config
        target: /opt/duan/sha/plan-agendas/west_holiday_2019.json

    networks:
      - mwxing-network-overlay
    deploy:
      replicas: 1
      endpoint_mode: dnsrr

  sa-aad:
    image: 192.168.0.158:5000/xiaoji-sa-aad
    hostname: sa-aad
    configs:
      - source: aad_config
        target: /usr/verticles/aad.json

    networks:
      - mwxing-network-overlay
    deploy:
      replicas: 1
      endpoint_mode: dnsrr

configs:
  zuul_config:
    file: ./zuulserver/application.properties
  aac_config:
    file: ./aac/application.properties
  aba_config:
    file: ./aba/application.properties
  abc_config:
    file: ./abc/application.properties
  abd_config:
    file: ./abd/application.properties
  agd_config:
    file: ./agd/application.properties
  sha_config:
    file: ./sha/sha.json
  sha_chinese_holiday_2019_config:
    file: ./sha/sha/plan/chinese_holiday_2019.json
  sha_chinese_famous_2019_config:
    file: ./sha/sha/plan/chinese_famous_2019.json
  sha_chinese_follow_2019_config:
    file: ./sha/sha/plan/chinese_follow_2019.json
  sha_shanghai_animation_exhibition_2019_config:
    file: ./sha/sha/plan/shanghai_animation_exhibition_2019.json
  sha_west_holiday_2019_config:
    file: ./sha/sha/plan/west_holiday_2019.json
  sha_chinese_holiday_2019_agendas_config:
    file: ./sha/sha/plan-agendas/chinese_holiday_2019.json
  sha_chinese_famous_2019_agendas_config:
    file: ./sha/sha/plan-agendas/chinese_famous_2019.json
  sha_chinese_follow_2019_agendas_config:
    file: ./sha/sha/plan-agendas/chinese_follow_2019.json
  sha_shanghai_animation_exhibition_2019_agendas_config:
    file: ./sha/sha/plan-agendas/shanghai_animation_exhibition_2019.json
  sha_west_holiday_2019_agendas_config:
    file: ./sha/sha/plan-agendas/west_holiday_2019.json
  aad_config:
    file: ./aad/aad.json

networks:
  mwxing-network-overlay:
    external: true
